<html>
<head>
<title>Lab 9.7</title>
</head>
<body>
<script>

// Part 1
document.write("<br><b>Part 1</b><br>");

var a = sum(2,2);
function sum(x,y) { return x+y; }
document.write("A = " + a);

//var a2 = sum2(2,2);
//var sum2 = function(x,y) { return x+y; }
//document.write("A2 = " + a2);

// Part 2
document.write("<br><b>Part 2</b><br>");

function f(p) {
  if (p>0) return p;
}
x = f(5);
document.write("F(5) = " + x + "<br>");
x = f(-5);
document.write("F(-5) = " + x + "<br>");

// Part 3 - no overload in JS - second definition just use name func for new function
document.write("<br><b>Part 3</b><br>");

function func(param) { document.write("First declaration"); }
function func() { document.write("Second declaration"); }
func(2);

// Part 4
document.write("<br><b>Part 4</b><br>");

// global variable p4 is defined
function f4_1() { p4 = 5; }
f4_1();
document.write("P1 = " + p4);

// local variable q4 is defined, so error occurred while using undefined variable document.write
//function f4_2() { var q4 = 5; }
//f4_2();
//document.write("P2 = " + q4);

// Part 5
document.write("<br><b>Part 5</b><br>");

var run = function(distance, speed)
{
  document.write("In function run(): count of given arguments = " + arguments.length + "<br>")
  speed = speed || 10;
  var time = distance / speed;
  document.write("In function run(): dist = " + distance + ", speed = " + speed + ", time = " + time + ";<br>")
  return time;
}

document.write("Case 5.1 : " + run() + "<br>");
document.write("Case 5.2 : " + run(10) + "<br>");
document.write("Case 5.3 : " + run(10, 5) + "<br>");
document.write("Case 5.4 : " + run(10, 5, 2, 7) + "<br>");

// Part 6
document.write("<br><b>Part 6</b><br>");

function f6()
{
  let cnt = arguments.length;
  let sum = 0;
  for(i=0; i<cnt; i++)
    sum += arguments[i];
  return sum / cnt;
}
document.write("f(1,2,3) = " + f6(1,2,3) + "<br>");

var m = [1,2,3,4,5];
document.write("f(m) = " + f6.apply(document,m) + "<br>");

// Part 7
document.write("<br><b>Part 7</b><br>");

function resize(toWidth, toHeight, saveProportions, animate)
{
  // значения по умолчанию
  saveProportions = saveProportions || true
  animate = animate || true
  toHeight = toHeight || 300

  document.write("resize values: W=" + toWidth + ", H=" + toHeight + ", P="
    + saveProportions + ", A=" + animate + "<br>");
}
resize(100, null, null, true);

function resize2(setup) {
  // значения по умолчанию
  var saveProportions = setup.saveProportions || true
  var animate = setup.animate || true
  var toHeight = setup.toHeight || 300
  var toWidth = setup.toWidth || 200

  document.write("resize values: W=" + toWidth + ", H=" + toHeight + ", P="
    + saveProportions + ", A=" + animate + "<br>");
}
resize2({toWidth: 100, animate: true})

// Part 8
document.write("<br><b>Part 8</b><br>");

function makeShout()
{
  var phrase = "Привет!";
  var shout = function()
  {
    document.write("Inside shout(): " + phrase);
  }

  phrase = "Готово!"
  return shout;
}

shout = makeShout();
// что выдаст? - "Готово!", т.к. в ее окружении phrase = "Готово!"
shout();

// Part 9
document.write("<br><b>Part 9</b><br>");

function summa(val1)
{
  function internal_summa(val2) { return val1 + val2; }
  return internal_summa;
}
document.write("sum(2)(2): " + summa(2)(2) + "<br>");
var plus1 = summa(1);
document.write("plus1(3): " + plus1(3) + "<br>");

// Part 10
document.write("<br><b>Part 10</b><br>");

function makeProperty(o, name, predicate)
{
  var value;
  o["get" + name] = function() { return value; };
  o["set" + name] = function(v)
  {
    if (predicate && !predicate(v))
      throw "set" + name + ": invalid value " + v;
    else
      value = v;
  };
}

var o = {};
makeProperty(o, "Name", function(x) { return typeof x == "string"; });
o.setName("Frank");
document.write("o.getName(): " + o.getName() + "<br>");
o.setName(0);
// exception thrown
document.write("o.getName(): " + o.getName() + "<br>");

</script>
</body>
</html>
